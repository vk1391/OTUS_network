# Проектирование сети
![alt-dtp](https://github.com/vk1391/OTUS_network/blob/main/11.jpg "Схема к домашнему заданию №4")
 ## Выделенные адреса в г.Москва:
**Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | -- 
 Москва | 1001 | VPC1 | eth0 | 172.16.0.2 | 255.255.255.252
 Москва | 1001 | VPC2 | eth0 | 172.16.0.6 | 255.255.255.252
 Москва | 1001 | R12 | e0/0 | 172.16.0.1 | 255.255.255.252
 Москва | 1001 | R12 | e0/2 | 172.16.1.1 | 255.255.255.252
 Москва | 1001 | R12 | e0/3 | 172.16.1.5 | 255.255.255.252
 Москва | 1001 | R13 | e0/0 | 172.16.0.5 | 255.255.255.252
 Москва | 1001 | R13 | e0/2 | 172.16.1.13 | 255.255.255.252
 Москва | 1001 | R13 | e0/3 | 172.16.1.10 | 255.255.255.252
 Москва | 1001 | R14 | e0/0 | 172.16.1.2 | 255.255.255.252
 Москва | 1001 | R14 | e0/1 | 172.16.1.9 | 255.255.255.252
 Москва | 1001 | R14 | e0/2 | 10.110.111.1 | 255.255.255.252
 Москва | 1001 | R14 | e0/3 | 172.16.1.17 | 255.255.255.252
 Москва | 1001 | R15 | e0/0 | 172.16.1.14 | 255.255.255.252
 Москва | 1001 | R15 | e0/1 | 172.16.1.6 | 255.255.255.252
 Москва | 1001 | R15 | e0/2 | 10.110.111.5 | 255.255.255.252
 Москва | 1001 | R15 | e0/3 | 172.16.1.21 | 255.255.255.252
 Москва | 1001 | R19 | e0/0 | 172.16.1.18 | 255.255.255.252
 Москва | 1001 | R20 | e0/0 | 172.16.1.22 | 255.255.255.252

 ## Выделенные адреса в г.Санкт-Петербург:
 **Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | -- 
 Санкт-Петербург | 2042 | VPC8 | eth0 | 172.20.0.2 | 255.255.255.252
 Санкт-Петербург | 2042 | VPC | eth0 | 172.20.0.6 | 255.255.255.252
 Санкт-Петербург | 2042 | R17 | e0/0 | 172.20.0.1 | 255.255.255.252
 Санкт-Петербург | 2042 | R17 | e0/1 | 172.20.1.6 | 255.255.255.252
 Санкт-Петербург | 2042 | R16 | e0/0 | 172.20.0.5 | 255.255.255.252
 Санкт-Петербург | 2042 | R16 | e0/1 | 172.20.1.2 | 255.255.255.252
 Санкт-Петербург | 2042 | R16 | e0/3 | 172.20.1.9 | 255.255.255.252
 Санкт-Петербург | 2042 | R18 | e0/0 | 172.20.1.1 | 255.255.255.252
 Санкт-Петербург | 2042 | R18 | e0/1 | 172.20.1.5 | 255.255.255.252
 Санкт-Петербург | 2042 | R18 | e0/2 | 10.100.110.1 | 255.255.255.252
 Санкт-Петербург | 2042 | R18 | e0/3 | 10.100.110.5 | 255.255.255.252
 Санкт-Петербург | 2042 | R32 | e0/0 | 172.20.1.10 | 255.255.255.252
 
 ## Выделенные адреса в г.Чокурдах:
 **Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | -- 
 Чокурдах | - | VPC30 | eth0 | 172.31.0.2 | 255.255.255.248
 Чокурдах | - | VPC | eth0 | 172.31.0.3 | 255.255.255.248
 Чокурдах | - | R28 | e0/0 | 172.31.132.1 | 255.255.255.252
 Чокурдах | - | R28 | e0/1 | 172.31.132.5 | 255.255.255.252
 Чокурдах | - | R28 | e0/2 | 172.31.0.1 | 255.255.255.248
 
 ## Выделенные адреса в г.Лабытнанги:
 **Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | --- 
 Лабытнанги | - | R27 | e0/0 | 10.111.112.2 | 255.255.255.252

 ## Выделенные адреса Триада:
 **Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | --- 
 Триада | 520 | R23 | e0/0 | 101.10.1.6 | 255.255.255.252 
 Триада | 520 | R23 | e0/1 | 11.1.110.1 | 255.255.255.252
 Триада | 520 | R23 | e0/2 | 11.1.110.5 | 255.255.255.252
 Триада | 520 | R24 | e0/0 | 172.110.0.2 | 255.255.255.252
 Триада | 520 | R24 | e0/1 | 11.1.110.9 | 255.255.255.252
 Триада | 520 | R24 | e0/2 | 11.1.110.6 | 255.255.255.252
 Триада | 520 | R24 | e0/3 | 10.100.110.2 | 255.255.255.252
 Триада | 520 | R25 | e0/0 | 11.1.110.2 | 255.255.255.252
 Триада | 520 | R25 | e0/1 | 10.111.112.1 | 255.255.255.252
 Триада | 520 | R25 | e0/2 | 11.1.110.14 | 255.255.255.252
 Триада | 520 | R25 | e0/3 | 172.31.132.6 | 255.255.255.252
 Триада | 520 | R26 | e0/0 | 11.1.110.10 | 255.255.255.252
 Триада | 520 | R26 | e0/1 | 172.31.132.2 | 255.255.255.252
 Триада | 520 | R26 | e0/2 | 11.1.110.13 | 255.255.255.252
 Триада | 520 | R26 | e0/3 | 10.100.110.6 | 255.255.255.252

 ## Выделенные адреса Ламас:
 **Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | --- 
 Ламас | 301 | R21 | e0/0 | 10.110.111.6 | 255.255.255.252
 Ламас | 301 | R21 | e0/1 | 101.10.1.2 | 255.255.255.252
 Ламас | 301 | R21 | e0/2 | 172.110.0.1 | 255.255.255.252

 ## Выделенные адреса Киторн:
 **Город** | **AS№** | **Устройство** | **Интерфейс** | **ip address** | **Маска подсети**
 --- | --- | --- | --- | --- | --- 
 Киторн | 101 | R22 | e0/0 | 10.110.111.2 | 255.255.255.252
 Киторн | 101 | R22 | e0/1 | 101.10.1.1 | 255.255.255.252
 Киторн | 101 | R22 | e0/2 | 101.10.1.5 | 255.255.255.252

 # Настройка политики маршрутизации в офисе Чокурдах
  - необходимо настроить:
  1. Политику маршрутизации для сетей офиса.
  2. Распределить трафик между двумя линками с провайдером.
  3. Настроить отслеживание линка через технологию IP SLA.(только для IPv4)
  4. Настроить для офиса Лабытнанги маршрут по-умолчанию.
  - Конфигурация маршрутизатора R28:
```
interface Ethernet0/0
 ip address 172.31.132.1 255.255.255.252
!
interface Ethernet0/1
 ip address 172.31.132.5 255.255.255.252
!
interface Ethernet0/2
 ip address 172.31.0.1 255.255.255.248
 ip policy route-map TEST
!
interface Ethernet0/3
 no ip address
 shutdown
!
interface Ethernet1/0
 no ip address
 shutdown
!
interface Ethernet1/1
 no ip address
 shutdown
!
interface Ethernet1/2
 no ip address
 shutdown
!
interface Ethernet1/3
 no ip address
 shutdown
!         
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip route 0.0.0.0 0.0.0.0 172.31.132.2 10
ip route 0.0.0.0 0.0.0.0 172.31.132.6 10
!
ip access-list standard ACL1
 permit 172.31.0.3
ip access-list standard ACL2
 permit 172.31.0.2
!
ip sla 1
 icmp-echo 172.31.132.2 source-ip 172.31.132.1
 frequency 10
ip sla schedule 1 life forever start-time now
ip sla 2
 icmp-echo 172.31.132.6 source-ip 172.31.132.5
 frequency 11
ip sla schedule 2 life forever start-time now
!
route-map TEST permit 10
 match ip address ACL1
 set ip next-hop 172.31.132.6
!
route-map TEST permit 20
 match ip address ACL2
 set ip next-hop 172.31.132.2
!
route-map TEST deny 30
```
- Конфигурация маршрутизатора R27:
```
interface Ethernet0/0
 ip address 10.111.112.2 255.255.255.252
!
interface Ethernet0/1
 no ip address
 shutdown
!         
interface Ethernet0/2
 no ip address
 shutdown
!
interface Ethernet0/3
 no ip address
 shutdown
!
interface Ethernet1/0
 no ip address
 shutdown
!
interface Ethernet1/1
 no ip address
 shutdown
!
interface Ethernet1/2
 no ip address
 shutdown
!
interface Ethernet1/3
 no ip address
 shutdown 
!
ip forward-protocol nd
!
!
no ip http server
no ip http secure-server
ip route 0.0.0.0 0.0.0.0 10.111.112.1 name default
```
- Результат:
1. VPC30:
```
VPCS> sh ip

NAME        : VPCS[1]
IP/MASK     : 172.31.0.2/30
GATEWAY     : 172.31.0.1
DNS         : 
MAC         : 00:50:79:66:68:1e
LPORT       : 20000
RHOST:PORT  : 127.0.0.1:30000
MTU         : 1500

VPCS> trace 10.111.112.2
trace to 10.111.112.2, 8 hops max, press Ctrl+C to stop
 1   172.31.0.1   2.373 ms  1.776 ms  1.486 ms
 2   172.31.132.2   20.109 ms  3.058 ms  4.091 ms
 3   11.1.110.14   8.481 ms  3.485 ms  4.360 ms
 4   *10.111.112.2   4.331 ms
```
2. VPC31:
```
VPCS> sh ip

NAME        : VPCS[1]
IP/MASK     : 172.31.0.3/29
GATEWAY     : 172.31.0.1
DNS         : 
MAC         : 00:50:79:66:68:06
LPORT       : 20000
RHOST:PORT  : 127.0.0.1:30000
MTU         : 1500

VPCS> trace 10.111.112.2
trace to 10.111.112.2, 8 hops max, press Ctrl+C to stop
 1   172.31.0.1   1.102 ms  1.145 ms  1.606 ms
 2   172.31.132.6   3.060 ms  3.625 ms  3.083 ms
 3   *10.111.112.2   5.945 ms
```
3. Результат IP SLA на R28:
```
Router#show ip sla statistics 
IPSLAs Latest Operation Statistics

IPSLA operation id: 1
Latest RTT: 1 milliseconds
Latest operation start time: 10:08:10 UTC Tue Jul 9 2024
Latest operation return code: OK
Number of successes: 74
Number of failures: 1
Operation time to live: Forever

IPSLA operation id: 2
Latest RTT: 2 milliseconds
Latest operation start time: 10:08:11 UTC Tue Jul 9 2024
Latest operation return code: OK
Number of successes: 46
Number of failures: 0
Operation time to live: Forever
```
# Настройка маршрутизации в офисе Москва
- Необходимо выполнить следующие условия:
1. Маршрутизаторы R14-R15 находятся в зоне 0 - backbone.
2. Маршрутизаторы R12-R13 находятся в зоне 10. Дополнительно к маршрутам должны получать маршрут по умолчанию.
3. Маршрутизатор R19 находится в зоне 101 и получает только маршрут по умолчанию.
4. Маршрутизатор R20 находится в зоне 102 и получает все маршруты, кроме маршрутов до сетей зоны 101
